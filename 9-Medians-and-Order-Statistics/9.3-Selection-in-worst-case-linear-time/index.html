<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>9.3 Selection in worst-case linear time - Introduction to Algorithms</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "9.3 Selection in worst-case linear time";
    var mkdocs_page_input_path = "9-Medians-and-Order-Statistics/9.3-Selection-in-worst-case-linear-time.md";
    var mkdocs_page_url = "/9-Medians-and-Order-Statistics/9.3-Selection-in-worst-case-linear-time/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="../../mathjaxconfig.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Introduction to Algorithms</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Introduction</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>2 Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../2-Getting-Started/2.1-Insertion-sort/">2.1 Insertion sort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../2-Getting-Started/2.2-Analyzing-algorithms/">2.2 Analyzing algorithms</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../2-Getting-Started/2.3-Designing-algorithms/">2.3 Designing algorithms</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../2-Getting-Started/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>3 Growth of Functions</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../3-Growth-of-Functions/3.1-Asymptotic-notation/">3.1 Asymptotic notation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../3-Growth-of-Functions/3.2-Standard-notations-and-common-functions/">3.2 Standard notations and common functions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../3-Growth-of-Functions/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>4 Divide and Conquer</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.1-The-maximum-subarray-problem/">4.1 The maximum-subarray problem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.2-Strassen's-algorithm-for-matrix-multiplication/">4.2 Strassen's algorithm for matrix multiplication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.3-The-substitution-method-for-solving-recurrences/">4.3 The substitution method for solving recurrences</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.4-The-recursion-tree-method-for-solving-recurrences/">4.4 The recursion-tree method for solving recurrences</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.5-The-master-method-for-solving-recurrences/">4.5 The master method for solving recurrences</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/4.6-Proof-of-the-master-theorem/">4.6 Proof of the master theorem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../4-Divide-and-Conquer/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>5 Probabilistic Analysis and Randomized Algorithms</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../5-Probabilistic-Analysis-and-Randomized-Algorithms/5.1-The-hiring-problem/">5.1 The hiring problem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../5-Probabilistic-Analysis-and-Randomized-Algorithms/5.2-Indicator-random-variables/">5.2 Indicator random variables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../5-Probabilistic-Analysis-and-Randomized-Algorithms/5.3-Randomized-algorithms/">5.3 Randomized algorithms</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../5-Probabilistic-Analysis-and-Randomized-Algorithms/5.4-Probabilistic-analysis-and-further-uses-of-indicator-random-variables/">5.4 Probabilistic analysis and further uses of indicator random variables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../5-Probabilistic-Analysis-and-Randomized-Algorithms/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>6 Heapsort</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/6.1-Heaps/">6.1 Heaps</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/6.2-Maintaining-the-heap-property/">6.2 Maintaining the heap property</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/6.3-Building-a-heap/">6.3 Building a heap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/6.4-The-heapsort-algorithm/">6.4 The heapsort algorithm</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/6.5-Priority-queues/">6.5 Priority queues</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../6-Heapsort/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>7 Quicksort</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../7-Quicksort/7.1-Description-of-quicksort/">7.1 Description of quicksort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../7-Quicksort/7.2-Performance-of-quicksort/">7.2 Performance of quicksort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../7-Quicksort/7.3-A-randomized-version-of-quicksort/">7.3 A randomized version of quicksort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../7-Quicksort/7.4-Analysis-of-quicksort/">7.4 Analysis of quicksort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../7-Quicksort/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>8 Sorting in Linear Time</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../8-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/">8.1 Lower bounds for sorting</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../8-Sorting-in-Linear-Time/8.2-Counting-sort/">8.2 Counting sort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../8-Sorting-in-Linear-Time/8.3-Radix-sort/">8.3 Radix sort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../8-Sorting-in-Linear-Time/8.4-Bucket-sort/">8.4 Bucket sort</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../8-Sorting-in-Linear-Time/Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>9 Medians and Order Statistics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../9.1-Minimum-and-maximum/">9.1 Minimum and maximum</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../9.2-Selection-in-expected-linear-time/">9.2 Selection in expected linear time</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">9.3 Selection in worst-case linear time</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#93-selection-in-worst-case-linear-time">9.3 Selection in worst-case linear time</a></li>
                
                    <li><a class="toctree-l4" href="#93-1">9.3-1</a></li>
                
                    <li><a class="toctree-l4" href="#93-2">9.3-2</a></li>
                
                    <li><a class="toctree-l4" href="#93-3">9.3-3</a></li>
                
                    <li><a class="toctree-l4" href="#93-4">9.3-4</a></li>
                
                    <li><a class="toctree-l4" href="#93-5">9.3-5</a></li>
                
                    <li><a class="toctree-l4" href="#93-6">9.3-6</a></li>
                
                    <li><a class="toctree-l4" href="#93-7">9.3-7</a></li>
                
                    <li><a class="toctree-l4" href="#93-8">9.3-8</a></li>
                
                    <li><a class="toctree-l4" href="#93-9">9.3-9</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Problems/">Problems</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Introduction to Algorithms</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>9 Medians and Order Statistics &raquo;</li>
        
      
    
    <li>9.3 Selection in worst-case linear time</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="93-selection-in-worst-case-linear-time">9.3 Selection in worst-case linear time</h1>
<h2 id="93-1">9.3-1</h2>
<p>Let's assume the input elements are divided into groups of k. Similar like the analysis in the book, at least half of the $\lceil \frac{n}{k} \rceil$ groups contribute at least $\lceil \frac{k}{2} \rceil$ elements that are greater than x, except for the one group that has fewer than k elements if k does not divide n exactly, and the one group containing x itself. Discounting these two groups, it follows that the number of elements greater than x is at least $\lceil \frac{k}{2} \rceil(\lceil \frac{1}{2} \lceil \frac{n}{k} \rceil \rceil - 2) \geq \frac{k}{2}(\frac{1}{2}\frac{n}{k} - 2) = \frac{n}{4} - k$.</p>
<p>Similarly, at least $\frac{n}{4} - k$ elements are less than x. Thus, in the worst case, step 5 calls SELECT recursively on at most $\frac{3n}{4} + k$ elements.</p>
<p>So when n is greater than some constant, we have $T(n) \leq T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + O(n)$. We assume T(n) runs in linear time, substituting it into the recurrence yields:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;\leq&amp; T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + O(n) \\
&amp;\leq&amp; T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + an \\
&amp;\leq&amp; c\frac{n}{k} + c(\frac{3n}{4} + k) + an \\
&amp;=&amp; cn + (\frac{c}{k}n + an - \frac{c}{4}n + ck) \\
&amp;\leq&amp; cn
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $\frac{c}{k}n + an - \frac{c}{4}n + ck \leq 0$. So we need to find some k such that there exists constants c and a such that $\frac{c}{k}n + an - \frac{c}{4}n + ck \leq 0$.</p>
<p>We have $\frac{c}{k}n + an - \frac{c}{4}n + ck = c(\frac{n}{k} - \frac{n}{4} + k) + an \leq 0$. Because both c and a are positive, so it could only be $\frac{n}{k} - \frac{n}{4} + k \leq 0$. Let $f(k) = \frac{n}{k} - \frac{n}{4} + k$, so $f(4) = 4 &gt; 0, f(5) = -\frac{n}{20} + 5 \leq 0 \text{ when } n \geq 100$. So we can always find a $n_0$ such that $f(k) \leq 0$ when $k \geq 5$.</p>
<p>Thus the algorithm work in linear time if the input elements are divided into groups of 7, but doesn't run in linear time if they are divided into groups of 3.</p>
<h2 id="93-2">9.3-2</h2>
<p>We already know that there are at least $\frac{3n}{10} - 6$ elements are less (greater) than x, because $\lceil \frac{n}{4} \rceil &lt; \frac{n}{4} + 1$, let $\frac{3n}{10} - 6 \geq \frac{n}{4} + 1$, we get $n \geq 140$.</p>
<h2 id="93-3">9.3-3</h2>
<p>In the previous question, we already know that if $n \geq 140$, then at least $\lceil \frac{n}{4} \rceil$ elements are less (greater) than x. So the partition procedure splits the problem size to $\frac{n}{4}$ and $\frac{3n}{4}$ in quicksort. Thus, $T(n) = T(\frac{n}{4}) + T(\frac{3n}{4}) + \Theta(n)$. And the solution is $T(n) = \Theta(n\lg{n})$, which is solved in exercise 4.4-9.</p>
<h2 id="93-4">9.3-4</h2>
<h2 id="93-5">9.3-5</h2>
<p>The idea is similar.</p>
<pre><code>SELECT(A, p, r, i)

if p == r
    return A[p]
median = BLACK-BOX-MEDIAN(A, p, r)
q = PARTITION(A, p, r, median)
k = q - p + 1
if i == k
    return A[q]
elseif i &lt; k
    return SELECT(A, p, q - 1, i)
else
    return SELECT(A, q + 1, r, i - k)
</code></pre>

<p>First we find the median of the array, and use that median as pivot to partition the array. Then we recursively call the procedure to get the ith element. Now let's analysis the running time. The <code>BLAK-BOX-MEDIAN</code> takes O(n), and partition method also takes O(n), then it at least reduces the problem size to $\frac{n}{2}$, thus we have $T(n) = T(\frac{n}{2}) + O(n)$.</p>
<p>We guess T(n) = O(n), substituting it to the recurrence yielding:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\frac{n}{2}) + O(n) \\
&amp;\leq&amp; c\frac{n}{2} + dn \\
&amp;=&amp; (\frac{c}{2} + d)n \\
&amp;=&amp; O(n)
\end{eqnarray}
$$</p>
<p>So the algorithm solves the problem in linear time.</p>
<h2 id="93-6">9.3-6</h2>
<p>The k quantiles of an n-element set are $A[\lceil \frac{n}{k} \rceil], A[2\lceil \frac{n}{k} \rceil], \ldots, A[(k - 1)\lceil \frac{n}{k} \rceil]$. And the idea is simple, first we divide the elements into two parts, one part contains $\lceil \frac{k}{2} \rceil$ quantiles, and the other part contains $ k - \lceil \frac{k}{2} \rceil$ quantiles. Then we recursively call the procedure on the two parts. In order to divide the elements into two parts, we use the <code>SELECT</code> procedure to get the $\lceil \frac{k}{2} \rceil\lceil \frac{n}{k} \rceil$th smallest element, which is the last element of the $\lceil \frac{k}{2} \rceil$ quantiles.</p>
<pre><code>KTH-QUANTILES(A, p, r, k)

if k == 1
    return
else:
    i = MATH.CEIL(k / 2) * SIZE-OF-ELEMENTS-IN-EACH-QUANTILE
    index, quantile = SELECT(A, p, r, i)
    OUTPUT quantile
    KTH-QUANTILES(A, p, index, MATH.CEIL(k / 2))
    KTH-QUANTILES(A, index + 1, r, k - MATH.CEIL(k / 2))
</code></pre>

<p>Now let's analysis the running time. We have $T(n, k) = 2T(\frac{n}{2}, \frac{k}{2}) + O(n)$. If we draw a recursion tree, we can see that each level of the tree costs O(n) and the depth of tree is $\lg{k}$, thus the running time is $O(n\lg{k})$.</p>
<h2 id="93-7">9.3-7</h2>
<p>First, we find the median of the set, it costs O(n), then we create another array that contains the absolute distance between the median and each element. Then we use the <code>SELECT</code> procedure to select the kth smallest element p in the new array, at last, we compare each element in S with median, if the distance between element and median is not greater than p, then the element one of the k closest elements. Each step costs O(n), so the algorithm runs in O(n).</p>
<pre><code>K-CLOSEST(A, k)

i = MATH.CEIL(A.length / 2)
median = SELECT(A, i)
let B[1..n] be a new array
for j = 1 to n
    B[j] = MATH.ABS(A[j] - median)
kth = SELECT(B, k)
let C be a new array
for j = 1 to n
    if MATH.ABS(A[j] - median) &lt; kth
        add A[j] to C
for j = 1 to n
    MATH.ABS(A[j] - median) == kth
        add A[j] to C
    if C.length &gt;= k
        break
return C
</code></pre>

<p>Because the elements in <code>A</code> are all distinct, so each element in <code>B</code> have at most 1 duplicate. The reason to scan <code>A</code> twice to get <code>C</code> is that <code>A</code> is not sorted, if we combine the last two loops together, it is possible we cannot get the correct k closest elements to the median.</p>
<h2 id="93-8">9.3-8</h2>
<p>We can first get the medians of x and y, if the median of x is smaller than the median of y, then the median of all is in x's right part and y's left part, if the median of x is larger than the median of y, then the median of all is in x's left part and y's right part. So we can recursively solves the problem.</p>
<pre><code>MEDIAN-OF-TWO-SORTED-ARRAYS(X, px, rx, Y, py, ry)

if rx - px == 1
    if X[px] &lt;= Y[py]
        return MATH.MIN(X[rx], Y[py])
    else:
        return MATH.MIN(X[px], Y[ry])
median-index-of-x = MATH.FLOOR((px + rx) / 2)
median-index-of-y = MATH.FLOOR((py + ry) / 2)
if X[index] &lt; Y[median-index-of-y]
    return MEDIAN-OF-TWO-SORTED-ARRAYS(X, index, rx, Y, py, median-index-of-y)
elif X[index] &gt; Y[median-index-of-y]
    return MEDIAN-OF-TWO-SORTED-ARRAYS(X, px, index, Y, median-index-of-y, ry)
else:
    return X[index]
</code></pre>

<p>Each recursive procedure reduces the problem size to $\frac{n}{2}$, so we have $T(n) = T(\frac{n}{2}) + \Theta(1)$. Let's solve the recurrence by the master method. Here we have a = 1, b = 2, $f(n) = \Theta(1)$. so $n^{\log_b{a}} = 1$, thus $f(n) = \Theta(n^{\log_b{a}})$, so $T(n) = \Theta(n^{\log_b{a}}\lg{n}) = \Theta(\lg{n})$.</p>
<h2 id="93-9">9.3-9</h2>
<p>Suppose the n wells have y-coordinates $y_1, y_2, \ldots, y_n$, and we need to find $y_0$ such that the value $\sum_{i = 1}^{n}|y_i - y_0|$ is minimum. This is the 1-dimensional case of <a href="https://en.wikipedia.org/wiki/Geometric_median">Geometric median</a>, and the median minimize the sum. <a href="https://math.stackexchange.com/questions/318381/on-a-1-d-line-the-point-that-minimizes-the-sum-of-the-distances-is-the-median">Explanation</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Problems/" class="btn btn-neutral float-right" title="Problems">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../9.2-Selection-in-expected-linear-time/" class="btn btn-neutral" title="9.2 Selection in expected linear time"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../9.2-Selection-in-expected-linear-time/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Problems/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
