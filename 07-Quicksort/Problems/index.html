<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Problems - Introduction to Algorithms</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Problems";
    var mkdocs_page_input_path = "07-Quicksort\\Problems.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Introduction to Algorithms</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">2 Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.1-Insertion-sort/">2.1 Insertion sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.2-Analyzing-algorithms/">2.2 Analyzing algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.3-Designing-algorithms/">2.3 Designing algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">3 Growth of Functions</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.1-Asymptotic-notation/">3.1 Asymptotic notation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.2-Standard-notations-and-common-functions/">3.2 Standard notations and common functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">4 Divide and Conquer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.1-The-maximum-subarray-problem/">4.1 The maximum-subarray problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.2-Strassen's-algorithm-for-matrix-multiplication/">4.2 Strassen's algorithm for matrix multiplication</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.3-The-substitution-method-for-solving-recurrences/">4.3 The substitution method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.4-The-recursion-tree-method-for-solving-recurrences/">4.4 The recursion-tree method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.5-The-master-method-for-solving-recurrences/">4.5 The master method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.6-Proof-of-the-master-theorem/">4.6 Proof of the master theorem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">5 Probabilistic Analysis and Randomized Algorithms</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.1-The-hiring-problem/">5.1 The hiring problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.2-Indicator-random-variables/">5.2 Indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.3-Randomized-algorithms/">5.3 Randomized algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.4-Probabilistic-analysis-and-further-uses-of-indicator-random-variables/">5.4 Probabilistic analysis and further uses of indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">6 Heapsort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.1-Heaps/">6.1 Heaps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.2-Maintaining-the-heap-property/">6.2 Maintaining the heap property</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.3-Building-a-heap/">6.3 Building a heap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.4-The-heapsort-algorithm/">6.4 The heapsort algorithm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.5-Priority-queues/">6.5 Priority queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">7 Quicksort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../7.1-Description-of-quicksort/">7.1 Description of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../7.2-Performance-of-quicksort/">7.2 Performance of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../7.3-A-randomized-version-of-quicksort/">7.3 A randomized version of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../7.4-Analysis-of-quicksort/">7.4 Analysis of quicksort</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Problems</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#problems">Problems</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#7-1">7-1</a></li>
        
            <li><a class="toctree-l4" href="#7-2">7-2</a></li>
        
            <li><a class="toctree-l4" href="#7-3">7-3</a></li>
        
            <li><a class="toctree-l4" href="#7-4">7-4</a></li>
        
            <li><a class="toctree-l4" href="#7-5">7-5</a></li>
        
            <li><a class="toctree-l4" href="#7-6">7-6</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">8 Sorting in Linear Time</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/">8.1 Lower bounds for sorting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.2-Counting-sort/">8.2 Counting sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.3-Radix-sort/">8.3 Radix sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.4-Bucket-sort/">8.4 Bucket sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">9 Medians and Order Statistics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.1-Minimum-and-maximum/">9.1 Minimum and maximum</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.2-Selection-in-expected-linear-time/">9.2 Selection in expected linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.3-Selection-in-worst-case-linear-time/">9.3 Selection in worst-case linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">10 Elementary Data Structures</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.1-Stacks-and-queues/">10.1 Stacks and queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.2-Linked-lists/">10.2 Linked lists</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.3-Implementing-pointers-and-objects/">10.3 Implementing pointers and objects</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Introduction to Algorithms</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>7 Quicksort &raquo;</li>
        
      
    
    <li>Problems</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="problems">Problems</h1>
<h2 id="7-1">7-1</h2>
<h3 id="a">a</h3>
<p><img alt="Alt text" src="../7-1-a.png" /></p>
<p><img alt="Alt text" src="../7-1-b.png" /></p>
<p><img alt="Alt text" src="../7-1-c.png" /></p>
<p><img alt="Alt text" src="../7-1-d.png" /></p>
<p><img alt="Alt text" src="../7-1-e.png" /></p>
<p><img alt="Alt text" src="../7-1-f.png" /></p>
<p><img alt="Alt text" src="../7-1-g.png" /></p>
<p><img alt="Alt text" src="../7-1-h.png" /></p>
<p><img alt="Alt text" src="../7-1-i.png" /></p>
<p><img alt="Alt text" src="../7-1-j.png" /></p>
<p><img alt="Alt text" src="../7-1-k.png" /></p>
<p><img alt="Alt text" src="../7-1-l.png" /></p>
<p><img alt="Alt text" src="../7-1-m.png" /></p>
<p><img alt="Alt text" src="../7-1-n.png" /></p>
<p><img alt="Alt text" src="../7-1-o.png" /></p>
<p><img alt="Alt text" src="../7-1-p.png" /></p>
<h3 id="b">b</h3>
<p>We repeat <code>j = j - 1</code> from <code>r + 1</code> and repeat <code>i = i + 1</code> from <code>p - 1</code>, so <code>i</code> moves from left to right and <code>j</code> moves from right to left, the while loop terminates when <code>i &gt;= j</code>, thus, it will not access an element of A outside the subarray <code>A[p..r]</code>. But will it keep increasing <code>i</code> such that <code>i</code> is bigger than <code>r</code>? No, it's not possible, because we choose <code>A[p]</code> as pivot. So in the first iteration, <code>i</code> stops at <code>p</code>, and if <code>i &lt; j</code>, we exchange <code>A[i]</code> with <code>A[j]</code>, so the pivot is exchanged to right, thus it makes sure it stops keep increasing <code>i</code> when it meets the pivot in right.</p>
<h3 id="c">c</h3>
<p>Suppose the array is in increasing order, so it keeps increasing <code>j</code> until <code>j = p</code> because <code>A[p] &lt;= x</code>. So <code>j</code> could be <code>p</code>. In the while loop, <code>j</code> will be <code>r</code> first, because there are at least two elements in the array, it will keep increasing <code>j</code> or exchange <code>A[i]</code> with <code>A[j]</code>, if it increase <code>j</code>, we get <code>j &lt; r</code>, if we exchange <code>A[i]</code> with <code>A[j]</code>, then it also increase <code>j</code> in the next iteration, either makes <code>j &gt; r</code>. So <code>p &lt;= j &lt; r</code>.</p>
<h3 id="d">d</h3>
<p><code>j</code> stopes decreasing when <code>A[j] &lt;= x</code> and <code>i</code> stops increasing when <code>A[i] &gt;= x</code>, after exchanging <code>A[i]</code> with <code>A[j]</code>, it makes sure every element of <code>A[p..i]</code> is less than or equal to every element of <code>A[j..r]</code>. When it terminates, we have <code>j - i &lt;= 1</code>, so every element of <code>A[p..j]</code> is less than or equal to every element of <code>A[j + 1..r]</code>.</p>
<h3 id="e">e</h3>
<pre><code>QUICKSORT(A, p, r)
if p &lt; r
    q = HOARE-PARTITION(A, p, r)
    QUICKSORT(A, p, q)
    QUICKSORT(A, q + 1, r)

HOARE-PARTITION(A, p, r)
x = A[p]
i = p - 1
j = r + 1
while True
    repeat
        j = j - 1
    until A[j] &lt;= x
    repeat
        i = i + 1
    until A[i] &gt;= x
    if i &lt; j
        exchange A[i] with A[j]
    else return j
</code></pre>

<h2 id="7-2">7-2</h2>
<h3 id="a_1">a</h3>
<p>If all elements values are equal, then randomize the array won't make a difference. In exercise 7.2-2 we know the running time is $\Theta(n^2)$.</p>
<h3 id="b_1">b</h3>
<pre><code>PARTITION'(A, p, r)
x = A[r]
i = p - 1
t = p - 1
for j = p to r - 1
    if A[j] &lt; x
        t = t + 1
        i = i + 1
        exchange A[t] with A[i]

        if t != j:
            exchange A[j] with A[i]
    else if A[j] == x
        t = t + 1
        exchange A[t] with A[j]
exchange A[t + 1] with A[r]
return i + 1, t + 1
</code></pre>

<p>The running time is obviously $\Theta(r - p)$.</p>
<h3 id="c_1">c</h3>
<pre><code>RANDOMIZED-QUICKSORT'(A, p, r)
if p &lt; r
    q, t = RANDOMIZED-PARTITION'(A, p r)
    RANDOMIZED-QUICKSORT'(A, p, q - 1)
    RANDOMIZED-QUICKSORT'(A, t + 1, r)

RANDOMIZED-PARTITION'(A, p, r)
i = RANDOM(p, r)
exchange A[r] with A[i]
return PARTITION'(A, p, r)
</code></pre>

<pre><code>QUICKSORT'(A, p, r)
if p &lt; r
    q, t = RANDOMIZED-PARTITION'(A, p r)
    QUICKSORT'(A, p, q - 1)
    QUICKSORT'(A, t + 1, r)
</code></pre>

<h3 id="d_1">d</h3>
<p>If we use <code>QUICKSORT'</code>, then the worst-case becomes a best-case. If all elements of the array are the same, then the <code>PARTITION'</code> on the whole array splits the problem size to <code>[p, p - 1]</code> and <code>[r + 1, r]</code>, then the subproblem terminates. The running time is $\Theta(n)$.</p>
<p>So we can avoid the assumption that all elements are distinct, because if an array with size n contains duplicate elements, the running time is less than the running time of the array with distinct elements.</p>
<h2 id="7-3">7-3</h2>
<h3 id="a_2">a</h3>
<p>We choose the last element as pivot, but we randomize the array before that. It has the probability $\frac{1}{n}$ that an element will be put to the last position in array. So any particular element is chosen as the pivot is $\frac{1}{n}$. And $E[X_i] = \frac{1}{n}$.</p>
<h3 id="b_2">b</h3>
<p>First let's check the expected running time when element i is chosen as pivot. The <code>PARTITION</code> method takes $\Theta(n)$, and the problem size is splited to <code>[p, i - 1]</code> and <code>[i + 1, r]</code>, the running time of the two subproblems are $T(i - 1 - p + 1) = T(i - p)$ and $T(r - (i + 1) + 1) = T(r - i)$. Thus the running time is $E[X_i(T(i - p) + T(r - i) + \Theta(n))]$, where p = 1, r = n.</p>
<p>Thus $E[T(n)] = E[\sum_{q = 1}^n X_q(T(q - 1) + T(n - q) + \Theta(n))]$.</p>
<h3 id="c_2">c</h3>
<p>$$
\begin{eqnarray}
E[T(n)] &amp;=&amp; E[\sum_{q = 1}^n X_q(T(q - 1) + T(n - q) + \Theta(n))] \\
&amp;=&amp; E[\sum_{q = 1}^n \frac{1}{n}(T(q - 1) + T(n - q) + \Theta(n))] \\
&amp;=&amp; \frac{1}{n}E[T(0) + T(n - 1) + \Theta(n) + T(1) + T(n - 2) + \Theta(n) + \ldots + T(n - 1) + T(0) + \Theta(n)] \\
&amp;=&amp; \frac{1}{n}E[(T(0) + T(1) + \ldots + T(n - 1)) + (T(n - 1) + T(n - 2) + \ldots + T(0)) + n\Theta(n)] \\
&amp;=&amp; \frac{1}{n}E[2\sum_{q = 0}^{n - 1}T(q) + n\Theta(n)] \\
&amp;=&amp; \frac{2}{n}E[\sum_{q = 0}^{n - 1}T(q)] + \Theta(n) \\
&amp;=&amp; \frac{2}{n}\sum_{q = 0}^{n - 1}E[T(q)] + \Theta(n) \\
&amp;=&amp; \frac{2}{n}\sum_{q = 2}^{n - 1}E[T(q)] + \frac{2}{n}(E[T(0)] + E[T(1)]) + \Theta(n) \\
&amp;=&amp; \frac{2}{n}\sum_{q = 2}^{n - 1}E[T(q)] + \Theta(n)
\end{eqnarray}
$$</p>
<h3 id="d_2">d</h3>
<p>$$
\begin{eqnarray}
\sum_{k = 2}^{n - 1} k\lg{k} &amp;=&amp; \sum_{k = 2}^{\lceil \frac{n}{2} \rceil - 1} k\lg{k} + \sum_{k = \lceil \frac{n}{2} \rceil}^{n - 1} k\lg{k} \\
&amp;&lt;&amp; \sum_{k = 2}^{\frac{n}{2} + 1 - 1} k\lg{k} + \sum_{k = \frac{n}{2}}^{n - 1} k\lg{k} \\
&amp;=&amp; \sum_{k = 2}^{\frac{n}{2}} k\lg{k} + \sum_{k = \frac{n}{2}}^{n - 1} k\lg{k} \\
&amp;\leq&amp; \sum_{k = 2}^{\frac{n}{2}} k\lg{\frac{n}{2}} + \sum_{k = \frac{n}{2}}^{n - 1} k\lg{n} \\
&amp;=&amp; (\lg{n} - 1)\frac{(2 + \frac{n}{2})(\frac{n}{2} - 2 + 1)}{2} + \lg{n}\frac{(\frac{n}{2} + n - 1)(n - 1 - \frac{n}{2} + 1)}{2} \\
&amp;=&amp; (\lg{n} - 1)(\frac{n^2}{8} + \frac{n}{4} - 1) + \lg{n}(\frac{3n^2}{8} - \frac{n}{4}) \\
&amp;=&amp; \frac{1}{2}n^2\lg{n} - \frac{1}{8}n^2 -\lg{n} - \frac{n}{4} + 1 \\
&amp;&lt;=&amp; \frac{1}{2}n^2\lg{n} - \frac{1}{8}n^2 - \lg3 - \frac{3}{4} + 1 \\
&amp;&lt;&amp; \frac{1}{2}n^2\lg{n} - \frac{1}{8}n^2
\end{eqnarray}
$$</p>
<h3 id="e_1">e</h3>
<p>We stary by assuming that $E[T(n)] \leq an\lg{n}$ for all positive m &lt; n, yielding $E[T(q)] \leq aq\lg{q}$. Substituting into the equation:</p>
<p>$$
\begin{eqnarray}
E[T(n)]&amp;=&amp; \frac{2}{n}\sum_{q = 2}^{n - 1}E[T(q)] + \Theta(n) \\
&amp;\leq&amp; \frac{2}{n}\sum_{q = 2}^{n - 1} aq\lg{q} + \Theta(n) \\
&amp;=&amp; \frac{2a}{n}\sum_{q = 2}^{n - 1} q\lg{q} + \Theta(n) \\
&amp;\leq&amp; \frac{2a}{n}(\frac{1}{2}n^2\lg{n} - \frac{1}{8}n^2) + \Theta(n) \\
&amp;=&amp; an\lg{n} - \frac{a}{4}n + \Theta(n) \\
&amp;\leq&amp; an\lg{n} - \frac{a}{4}n + cn \\
&amp;=&amp; an\lg{n} - (\frac{a}{4} - c)n \\
&amp;\leq&amp; an\lg{n}
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $\frac{a}{4} \geq c$.</p>
<p>Thus $E[T(n)] = \Theta(n\lg{n})$.</p>
<h2 id="7-4">7-4</h2>
<h3 id="a_3">a</h3>
<p>The <code>PARTITION</code> method splits the array into two parts, then it sorts the left part first. At last it assigns the right part start index as the new value of p, so in the next iteration, it starts to sort the right part. Thus the whole array is sorted.</p>
<h3 id="b_3">b</h3>
<p>For example, when all elements in the array are same. The <code>PARTITION</code> method returns n, so the size of subproblems are n - 1 and 0, and it continues to call <code>TAIL-RECURSIVE-QUICKSORT</code> with size n - 1, but each recursive call only reduces the problem size by 1, thus the stack depth becomes $\Theta(n)$.</p>
<h3 id="c_3">c</h3>
<p>After we split the array into two parts, we call <code>TAIL-RECURSIVE-QUICKSORT</code> on the smaller part. The max size of smaller part is $\frac{n}{2}$, thus the max stack depth is $\Theta(\lg{n})$.</p>
<pre><code>TAIL-RECURSIVE-QUICKSORT(A, p, r)
while p &lt; r
    // Partition and sort left subarray.
    q = PARTITION(A, p, r)
    if q - p &gt; r - q
        TAIL-RECURSIVE-QUICKSORT(A, q + 1, r)
        r = q - 1
    else
        TAIL-RECURSIVE-QUICKSORT(A, p, q - 1)
        p = q + 1
</code></pre>

<h2 id="7-5">7-5</h2>
<h3 id="a_4">a</h3>
<p>If an element at index i is chosen as median, we need to pick one element in <code>A[1..i - 1]</code> and one element in <code>A[i + 1..n]</code>, and the picking order is not unique, so there are $A_3^{3}$ permutations. Thus the probability is $p_i = \frac{(i - 1)(n - i)A_3^{3}}{A_n{3}} = \frac{6(i - 1)(n - i)}{n(n - 1)(n - 2)}$.</p>
<h3 id="b_4">b</h3>
<p>The $p_i$ of oridinary implementation is $\frac{1}{n}$. So:</p>
<p>$$
\begin{eqnarray}
\frac{p_{\lfloor \frac{n + 1}{2} \rfloor}\frac{6(i - 1)(n - i)}{n(n - 1)(n - 2)}}{\frac{1}{n}} &amp;=&amp; \frac{\lim_{n \to \infty}\frac{6(\lfloor \frac{n + 1}{2} \rfloor - 1)(n - \lfloor \frac{n + 1}{2} \rfloor)}{n(n - 1)(n - 2)}}{\frac{1}{n}} \\
&amp;=&amp; \lim_{n \to \infty}\frac{6(\frac{n + 1}{2} - 1)(n - \frac{n + 1}{2})}{(n - 1)(n - 2)} \\
&amp;=&amp; \lim_{n \to \infty}\frac{6(\frac{n - 1}{2})^2}{(n - 1)(n - 2)} \\
&amp;=&amp; \frac{3}{2}
\end{eqnarray}
$$</p>
<h3 id="c_4">c</h3>
<p>The likehood of getting a good split of the ordinary implementation is:</p>
<p>$$
\begin{eqnarray}
\lim_{n \to \infty} \sum_{\frac{n}{3}}^{\frac{2n}{3}} \frac{1}{n} &amp;=&amp; \lim_{n \to \infty} \int_{\frac{n}{3}}^{\frac{2n}{3}} \frac{1}{n} di \quad (\int \frac{1}{n} di = \frac{i}{n}) \\
&amp;=&amp; \lim_{n \to \infty} \frac{\frac{2n}{3}}{n} - \frac{\frac{n}{3}}{n} \\
&amp;=&amp; \lim_{n \to \infty} (\frac{2}{3} - \frac{1}{3}) \\
&amp;=&amp; \frac{1}{3}
\end{eqnarray}
$$</p>
<p>The likehood of getting a good split of the new implementation is:</p>
<p>$$
\begin{eqnarray}
\lim_{n \to \infty} \sum_{\frac{n}{3}}^{\frac{2n}{3}} \frac{6(i - 1)(n - i)}{n(n - 1)(n - 2)} &amp;=&amp; \lim_{n \to \infty} \int_{\frac{n}{3}}^{\frac{2n}{3}} \frac{6(i - 1)(n - i)}{n(n - 1)(n - 2)} di \\
&amp;=&amp; \lim_{n \to \infty} \frac{6}{n(n - 1)(n - 2)} \int_{\frac{n}{3}}^{\frac{2n}{3}} (i - 1)(n - i) di \quad (\int (i - 1)(n - i) di = -\frac{1}{3}i^3 + \frac{n + 1}{2}i^2 - ni) \\
&amp;=&amp; \lim_{n \to \infty} \frac{6}{n(n - 1)(n - 2)} (-\frac{1}{3}(\frac{2n}{3})^3 + \frac{n + 1}{2}(\frac{2n}{3})^2 - n\frac{2n}{3} - (-\frac{1}{3}(\frac{n}{3})^3 + \frac{n + 1}{2}(\frac{n}{3})^2 - n\frac{n}{3})) \\
&amp;=&amp; \lim_{n \to \infty} \frac{6}{n(n - 1)(n - 2)}(-\frac{7}{81}n^3 + \frac{1}{6}n^3 - \frac{1}{6}n^2) \\
&amp;=&amp; 6(-\frac{7}{81} + \frac{1}{6}) \\
&amp;=&amp; \frac{13}{27}
\end{eqnarray}
$$</p>
<p>And the amount of improvement is $\frac{\frac{13}{27}}{\frac{1}{3}} = \frac{13}{9}$.</p>
<h3 id="d_3">d</h3>
<p>The best-case of quicksort happens when the middle element is chosen as the pivot. And the running time is $\Omega(n\lg{n})$. Event the median-of-3 method picks the middle element as the pivot each time, the running time is still $\Omega(n\lg{n})$, thus it affects only the constant factor.</p>
<h2 id="7-6">7-6</h2>
<h3 id="a_5">a</h3>
<p>The idea is similar like problem 7-2. Given an interval as pivot, we treat the intervals which overlap with the pivot are "equal element values". The <code>PARTITION</code> method returns two indices q and t, where $p \leq q \leq t \leq r$, such that:</p>
<ul>
<li>all intervals of <code>A[q..t]</code> overlap with <code>A[t]</code>,</li>
<li>the right ending of each interval of <code>A[p..q - 1]</code> is less than the left ending of <code>A[t]</code>,</li>
<li>the left ending of each interval of <code>A[t + 1..r]</code> is greater than the right ending of <code>A[t]</code>.</li>
</ul>
<pre><code>FUZZY-SORTING-OF-INTERVALS(A, p, r)
if p &lt; r
    q, t = RANDOMIZED-PARTITION(A, p r)
    FUZZY-SORTING-OF-INTERVALS(A, p, q - 1)
    FUZZY-SORTING-OF-INTERVALS(A, t + 1, r)

RANDOMIZED-PARTITION(A, p, r)
i = RANDOM(p, r)
exchange A[r] with A[i]
return PARTITION(A, p, r)

PARTITION(A, p, r)
x = A[r]
i = p - 1
t = p - 1
for j = p to r - 1
    if A[j] is before x
        t = t + 1
        i = i + 1
        exchange A[t] with A[i]

        if t != j:
            exchange A[j] with A[i]
    else if A[j] overlaps with x
        t = t + 1
        exchange A[t] with A[j]
exchange A[t + 1] with A[r]
return i + 1, t + 1
</code></pre>

<h3 id="b_5">b</h3>
<p>It's just a variation of problem 7-2, expected we use different comparision checks, so the expected running time is $\Theta(n\lg{n})$ in general.</p>
<p>When all of the intervals overlap, we treat them like all of the intervals are equal, thus like the analysis in problem 7-2, the expected running time is $\Theta(n)$.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../08-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/" class="btn btn-neutral float-right" title="8.1 Lower bounds for sorting">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../7.4-Analysis-of-quicksort/" class="btn btn-neutral" title="7.4 Analysis of quicksort"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../7.4-Analysis-of-quicksort/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../08-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../mathjax-config.js" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
