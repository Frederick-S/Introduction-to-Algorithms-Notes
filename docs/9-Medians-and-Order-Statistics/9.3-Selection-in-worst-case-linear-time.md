# 9.3 Selection in worst-case linear time
## 9.3-1
Let's assume the input elements are divided into groups of k. Similar like the analysis in the book, at least half of the $\lceil \frac{n}{k} \rceil$ groups contribute at least $\lceil \frac{k}{2} \rceil$ elements that are greater than x, except for the one group that has fewer than k elements if k does not divide n exactly, and the one group containing x itself. Discounting these two groups, it follows that the number of elements greater than x is at least $\lceil \frac{k}{2} \rceil(\lceil \frac{1}{2} \lceil \frac{n}{k} \rceil \rceil - 2) \geq \frac{k}{2}(\frac{1}{2}\frac{n}{k} - 2) = \frac{n}{4} - k$.

Similarly, at least $\frac{n}{4} - k$ elements are less than x. Thus, in the worst case, step 5 calls SELECT recursively on at most $\frac{3n}{4} + k$ elements.

So when n is greater than some constant, we have $T(n) \leq T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + O(n)$. We assume T(n) runs in linear time, substituting it into the recurrence yields:

$$
\begin{eqnarray}
T(n) &\leq& T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + O(n) \\\
&\leq& T(\lceil \frac{n}{k} \rceil) + T(\frac{3n}{4} + k) + an \\\
&\leq& c\frac{n}{k} + c(\frac{3n}{4} + k) + an \\\
&=& cn + (\frac{c}{k}n + an - \frac{c}{4}n + ck) \\\
&\leq& cn
\end{eqnarray}
$$

where the last step holds as long as $\frac{c}{k}n + an - \frac{c}{4}n + ck \leq 0$. So we need to find some k such that there exists constants c and a such that $\frac{c}{k}n + an - \frac{c}{4}n + ck \leq 0$.

We have $\frac{c}{k}n + an - \frac{c}{4}n + ck = c(\frac{n}{k} - \frac{n}{4} + k) + an \leq 0$. Because both c and a are positive, so it could only be $\frac{n}{k} - \frac{n}{4} + k \leq 0$. Let $f(k) = \frac{n}{k} - \frac{n}{4} + k$, so $f(4) = 4 > 0, f(5) = -\frac{n}{20} + 5 \leq 0 \text{ when } n \geq 100$. So we can always find a $n_0$ such that $f(k) \leq 0$ when $k \geq 5$.

Thus the algorithm work in linear time if the input elementes are divided into groups of 7, but doesn't run in linear time if they are divided into groups of 3.

## 9.3-2
