# 4.2 Strassen's algorithm for matrix multiplication
## 4.2-1
Step 1, we partition each of matrix A, B into four $\frac{n}{2} \text{ * } \frac{n}{2}$ matrices. So we have:

$$
A = \begin{pmatrix}
    A_{11} & A_{12} \\\\
    A_{21} & A_{22} \\\\
\end{pmatrix},
A_{11} = \begin{pmatrix}
    1
\end{pmatrix},
A_{12} = \begin{pmatrix}
    3
\end{pmatrix},
A_{21} = \begin{pmatrix}
    7
\end{pmatrix},
A_{22} = \begin{pmatrix}
    5
\end{pmatrix}
$$

$$
B = \begin{pmatrix}
    B_{11} & B_{12} \\\\
    B_{21} & B_{22} \\\\
\end{pmatrix},
B_{11} = \begin{pmatrix}
    6
\end{pmatrix},
B_{12} = \begin{pmatrix}
    8
\end{pmatrix},
B_{21} = \begin{pmatrix}
    4
\end{pmatrix},
B_{22} = \begin{pmatrix}
    2
\end{pmatrix}
$$

Step 2, we create 10 matrices:

$$S_1 = B_{12} - B_{22} = \begin{pmatrix} 6 \end{pmatrix}$$
$$S_2 = A_{11} + A_{12} = \begin{pmatrix} 4 \end{pmatrix}$$
$$S_3 = A_{21} + A_{22} = \begin{pmatrix} 12 \end{pmatrix}$$
$$S_4 = B_{21} - B_{11} = \begin{pmatrix} -2 \end{pmatrix}$$
$$S_5 = A_{11} + A_{22} = \begin{pmatrix} 6 \end{pmatrix}$$
$$S_6 = B_{11} + B_{22} = \begin{pmatrix} 8 \end{pmatrix}$$
$$S_7 = A_{12} - A_{22} = \begin{pmatrix} -2 \end{pmatrix}$$
$$S_8 = B_{21} + B_{22} = \begin{pmatrix} 6 \end{pmatrix}$$
$$S_9 = A_{11} - A_{21} = \begin{pmatrix} -6 \end{pmatrix}$$
$$S_{10} = B_{11} + B_{12} = \begin{pmatrix} 14 \end{pmatrix}$$

Step 3, we compute the seven matrix products:

$$P_1 = A_{11} * S_{1} = \begin{pmatrix} 6 \end{pmatrix}$$
$$P_2 = S_{2} * B_{22} = \begin{pmatrix} 8 \end{pmatrix}$$
$$P_3 = S_{3} * B_{11} = \begin{pmatrix} 72 \end{pmatrix}$$
$$P_4 = A_{22} * S_{4} = \begin{pmatrix} -10 \end{pmatrix}$$
$$P_5 = S_{5} * S_{6} = \begin{pmatrix} 48 \end{pmatrix}$$
$$P_6 = S_{7} * S_{8} = \begin{pmatrix} -12 \end{pmatrix}$$
$$P_7 = S_{9} * S_{10} = \begin{pmatrix} -84 \end{pmatrix}$$

Step 4, compute the desired submatrices:

$$C_{11} = P_5 + P_4 - P_2 + P_6 = \begin{pmatrix} 18 \end{pmatrix}$$
$$C_{12} = P_1 + P_2 = \begin{pmatrix} 14 \end{pmatrix}$$
$$C_{21} = P_3 + P_4 = \begin{pmatrix} 62 \end{pmatrix}$$
$$C_{22} = P_5 + P_1 - P_3 - P_7 = \begin{pmatrix} 66 \end{pmatrix}$$

So $C = \begin{pmatrix}
    C_{11} & C_{12} \\\\
    C_{21} & C_{22} \\\\
\end{pmatrix} = \begin{pmatrix}
    18 & 14 \\\\
    62 & 66 \\\\
\end{pmatrix}$.

## 4.2-2
```
SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(A, B)

n = A.rows
let C be a new n * n matrix
if n == 1
    C11 = A11 * B11
else partition A, B, and C as in equations (4.9)
    S1 = B12 - B22
    S2 = A11 + A12
    S3 = A21 + A22
    S4 = B21 - B11
    S5 = A11 + A22
    S6 = B11 + B22
    S7 = A12 - A22
    S8 = B21 + B22
    S9 = A11 - A21
    S10 = B11 + B12
    
    P1 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(A11, S1)
    P2 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(S2, B22)
    P3 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(S3, B11)
    P4 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(A22, S4)
    P5 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(S5, S6)
    P6 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(S7, S8)
    P7 = SQUARE-MATRIX-MULTIPLY-STRASSEN-ALGORITHM(S9, S10)
    
    C11 = P5 + P4 - P2 + P6
    C12 = P1 + P2
    C21 = P3 + P4
    C22 = P5 + P1 - P3 - P7
return C
```