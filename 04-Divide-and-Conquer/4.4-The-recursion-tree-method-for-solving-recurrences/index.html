<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>4.4 The recursion-tree method for solving recurrences - Introduction to Algorithms</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "4.4 The recursion-tree method for solving recurrences";
    var mkdocs_page_input_path = "04-Divide-and-Conquer\\4.4-The-recursion-tree-method-for-solving-recurrences.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Introduction to Algorithms</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">2 Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.1-Insertion-sort/">2.1 Insertion sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.2-Analyzing-algorithms/">2.2 Analyzing algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/2.3-Designing-algorithms/">2.3 Designing algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02-Getting-Started/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">3 Growth of Functions</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.1-Asymptotic-notation/">3.1 Asymptotic notation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.2-Standard-notations-and-common-functions/">3.2 Standard notations and common functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">4 Divide and Conquer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../4.1-The-maximum-subarray-problem/">4.1 The maximum-subarray problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../4.2-Strassen's-algorithm-for-matrix-multiplication/">4.2 Strassen's algorithm for matrix multiplication</a>
                </li>
                <li class="">
                    
    <a class="" href="../4.3-The-substitution-method-for-solving-recurrences/">4.3 The substitution method for solving recurrences</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">4.4 The recursion-tree method for solving recurrences</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#44-the-recursion-tree-method-for-solving-recurrences">4.4 The recursion-tree method for solving recurrences</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#44-1">4.4-1</a></li>
        
            <li><a class="toctree-l4" href="#44-2">4.4-2</a></li>
        
            <li><a class="toctree-l4" href="#44-3">4.4-3</a></li>
        
            <li><a class="toctree-l4" href="#44-4">4.4-4</a></li>
        
            <li><a class="toctree-l4" href="#44-5">4.4-5</a></li>
        
            <li><a class="toctree-l4" href="#44-6">4.4-6</a></li>
        
            <li><a class="toctree-l4" href="#44-7">4.4-7</a></li>
        
            <li><a class="toctree-l4" href="#44-8">4.4-8</a></li>
        
            <li><a class="toctree-l4" href="#44-9">4.4-9</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../4.5-The-master-method-for-solving-recurrences/">4.5 The master method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../4.6-Proof-of-the-master-theorem/">4.6 Proof of the master theorem</a>
                </li>
                <li class="">
                    
    <a class="" href="../Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">5 Probabilistic Analysis and Randomized Algorithms</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.1-The-hiring-problem/">5.1 The hiring problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.2-Indicator-random-variables/">5.2 Indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.3-Randomized-algorithms/">5.3 Randomized algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.4-Probabilistic-analysis-and-further-uses-of-indicator-random-variables/">5.4 Probabilistic analysis and further uses of indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">6 Heapsort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.1-Heaps/">6.1 Heaps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.2-Maintaining-the-heap-property/">6.2 Maintaining the heap property</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.3-Building-a-heap/">6.3 Building a heap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.4-The-heapsort-algorithm/">6.4 The heapsort algorithm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.5-Priority-queues/">6.5 Priority queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">7 Quicksort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.1-Description-of-quicksort/">7.1 Description of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.2-Performance-of-quicksort/">7.2 Performance of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.3-A-randomized-version-of-quicksort/">7.3 A randomized version of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.4-Analysis-of-quicksort/">7.4 Analysis of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">8 Sorting in Linear Time</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/">8.1 Lower bounds for sorting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.2-Counting-sort/">8.2 Counting sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.3-Radix-sort/">8.3 Radix sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.4-Bucket-sort/">8.4 Bucket sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">9 Medians and Order Statistics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.1-Minimum-and-maximum/">9.1 Minimum and maximum</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.2-Selection-in-expected-linear-time/">9.2 Selection in expected linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.3-Selection-in-worst-case-linear-time/">9.3 Selection in worst-case linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">10 Elementary Data Structures</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.1-Stacks-and-queues/">10.1 Stacks and queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.2-Linked-lists/">10.2 Linked lists</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Introduction to Algorithms</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>4 Divide and Conquer &raquo;</li>
        
      
    
    <li>4.4 The recursion-tree method for solving recurrences</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="44-the-recursion-tree-method-for-solving-recurrences">4.4 The recursion-tree method for solving recurrences</h1>
<h2 id="44-1">4.4-1</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = 3T(\frac{n}{2}) + n$ and assume that n is an exact power of 2.</p>
<p><img alt="Alt text" src="../4.4-1.png" /></p>
<p>Each level has three times more nodes than the level above, so the number of nodes at depth i is $3^i$. And each node at depth i, for $i = 0, 1, 2, \ldots, \lg{n} - 1$, has a cost of $\frac{n}{2^i}$. So the total cost over all nodes at depth i, is $3^i\frac{n}{2^i} = (\frac{3}{2})^in$. The bottom level, at depth $\lg{n}$, has $3^{\lg{n}} = n^{\lg{3}}$ nodes, each contributing cost $T(1)$, for a total cost of $n^{\lg{3}}T(1)$, which is $\Theta(n^{\lg{3}})$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; \sum_{i = 0}^{\lg{n} - 1}(\frac{3}{2})^in + \Theta(n^{\lg{3}}) \\
&amp;=&amp; n\frac{1 - (\frac{3}{2})^{\lg{n}}}{1 - \frac{3}{2}} + \Theta(n^{\lg3}) \\
&amp;=&amp; 2n\frac{3^{\lg{n}} - 2^{\lg{n}}}{2^{\lg{n}}} + \Theta(n^{\lg3}) \\
&amp;=&amp; 2n\frac{3^{\lg{n}} - 2^{\lg{n}}}{n} + \Theta(n^{\lg3}) \\
&amp;=&amp; 2(3^{\lg{n}} - 2^{\lg{n}}) + \Theta(n^{\lg3}) \\
&amp;=&amp; 2(n^{\lg{3}} -n) + \Theta(n^{\lg3}) \\
&amp;&lt;&amp; 2n^{\lg3} + \Theta(n^{\lg3}) \\
&amp;=&amp; O(n^{\lg3})
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n^{\lg3})$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq cn^{\lg3}$ for some constant $c &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 3T(\lfloor \frac{n}{2} \rfloor) + n \\
&amp;\leq&amp; 3c\lfloor \frac{n}{2} \rfloor^{\lg3} + n \\
&amp;\leq&amp; 3c(\frac{n}{2})^{\lg3} + n \\
&amp;=&amp; 3c(\frac{n}{2})^{\lg3} + n \\
&amp;=&amp; 3c\frac{n^{\lg3}}{2^{\lg3}} + n \\
&amp;=&amp; 3c\frac{n^{\lg3}}{3} + n \\
&amp;=&amp; cn^{\lg{3}} + n
\end{eqnarray}
$$</p>
<p>But $cn^{\lg{3}} + n &gt; cn^{\lg{3}}$, so we need to try another guess. Let's try $T(n) \leq cn^{\lg3} - \frac{2n}{3}$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 3T(\lfloor \frac{n}{2} \rfloor) + n \\
&amp;\leq&amp; 3(c\lfloor \frac{n}{2} \rfloor^{\lg3} - \frac{n}{3}) + n \\
&amp;\leq&amp; 3(c(\frac{n}{2})^{\lg3} - \frac{n}{3}) + n \\
&amp;=&amp; 3c(\frac{n}{2})^{\lg3} \\
&amp;=&amp; cn^{\lg3}
\end{eqnarray}
$$</p>
<h2 id="44-2">4.4-2</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = T(\frac{n}{2}) + n^2$ and assume that n is an exact power of 2.</p>
<p><img alt="Alt text" src="../4.4-2.png" /></p>
<p>The number of nodes at depth i is 1. And each node at depth i, for $i = 0, 1, 2, \ldots, \lg{n} - 1$, has a cost of $\frac{n^2}{4^i}$. So the total cost over all nodes at depth i, is $\frac{n^2}{4^i}$. The bottom level, at depth $\lg{n}$, has 1 node, which contributing cost $T(1)$, for a total cost of $T(1)$, which is $\Theta(1)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; \sum_{i = 0}^{\lg{n} - 1}\frac{n^2}{4^i} + \Theta(1) \\
&amp;&lt;&amp; \sum_{i = 0}^{\infty}\frac{n^2}{4^i} + \Theta(1) \\
&amp;=&amp; \frac{1}{1 - \frac{1}{4}}n^2 + \Theta(1) \\
&amp;=&amp; \frac{4}{3}n^2 + \Theta(1) \\
&amp;=&amp; O(n^2)
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n^2)$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq cn^2$ for some constant $c &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\frac{n}{2}) + n^2 \\
&amp;\leq&amp; c(\frac{n}{2})^2 + n^2 \\
&amp;=&amp; (\frac{c}{4} + 1)n^2 \\
&amp;\leq&amp; cn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $c \geq \frac{4}{3}$.</p>
<h2 id="44-3">4.4-3</h2>
<p>When n is large, the difference between $\frac{n}{2} + 2$ and $\frac{n}{2}$ not that large, so it's also a sloppiness that we can tolerate. Then let's create a recursion tree for the recurrence $T(n) = 4T(\frac{n}{2}) + n$ and assume that n is an exact power of 2.</p>
<p><img alt="Alt text" src="../4.4-3.png" /></p>
<p>Each level has four times more nodes than the level above, so the number of nodes at depth i is $4^i$. And each node at depth i, for $i = 0, 1, 2, \ldots, \lg{n} - 1$, has a cost of $\frac{n}{2^i}$. So the total cost over all nodes at depth i, is $4^i\frac{n}{2^i} = 2^in$. The bottom level, at depth $\lg{n}$, has $4^{\lg{n}} = n^2$ nodes, each contributing cost $T(1)$, for a total cost of $n^2T(1)$, which is $\Theta(n^2)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; \sum_{i = 0}^{\lg{n} - 1}2^in + \Theta(n^2) \\
&amp;=&amp; n\frac{1 - 2^{\lg{n}}}{1 - 2} + \Theta(n^2) \\
&amp;=&amp; n(n - 1) + \Theta(n^2) \\
&amp;=&amp; n^2 - n + \Theta(n^2) \\
&amp;=&amp; O(n^2)
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n^2)$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq cn^2$ for some constant $c &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 4T(\frac{n}{2} + 2) + n \\
&amp;\leq&amp; 4c(\frac{n}{2} + 2)^2 + n \\
&amp;=&amp; 4c(\frac{n^2}{4} + 2n + 4) + n \\
&amp;=&amp; cn^2 + 8cn + 16c + n \\
&amp;=&amp; cn^2 + (8c + 1)n + 16c
\end{eqnarray}
$$</p>
<p>But $cn^2 + (8c + 1)n + 16c &gt; cn^2$, so we need to try another guess, let's try $T(n) \leq cn^2 - 5n$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 4T(\frac{n}{2} + 2) + n \\
&amp;\leq&amp; 4c((\frac{n}{2} + 2)^2 - 5(\frac{n}{2} + 2)) + n \\
&amp;=&amp; 4c(\frac{n^2}{4} + 2n + 4 - \frac{5n}{2} - 10) + n \\
&amp;=&amp; 4c(\frac{n^2}{4} - \frac{n}{2} - 6) + n \\
&amp;=&amp; cn^2 + (1 - 2c)n - 24c \\
&amp;&lt;&amp; cn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $c \geq \frac{1}{2}$.</p>
<h2 id="44-4">4.4-4</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = 2T(n - 1) + 1$.</p>
<p><img alt="Alt text" src="../4.4-4.png" /></p>
<p>Each level has two times more nodes than the level above, so the number of nodes at depth i is $2^i$. And each node at depth i, for $i = 0, 1, 2, \ldots, n - 1 - 1$, has a cost of 1. So the total cost over all nodes at depth i, is $2^i$. The bottom level, at depth n, has $2^{n - 1}$ nodes, each contributing cost $T(1)$, for a total cost of $2^{n - 1}T(1)$, which is $\Theta(2^n)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; \sum_{i = 0}^{n - 1 - 1}2^i + \Theta(2^n) \\
&amp;=&amp; \frac{1 - 2^{n - 1}}{1 - 2} + \Theta(2^n) \\
&amp;=&amp; 2^{n - 1} - 1 + \Theta(2^n) \\
&amp;=&amp; O(2^n)
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(2^n)$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq c2^n$ for some constant $c &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 2T(n - 1) + 1 \\
&amp;\leq&amp; 2c2^{n - 1} + 1 \\
&amp;=&amp; c2^n + 1
\end{eqnarray}
$$</p>
<p>But $c2^n + 1 &gt; c2^n$, so we need to try another guess. Lets try $T(n) \leq c2^n - 1$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 2T(n - 1) + 1 \\
&amp;\leq&amp; 2(c2^{n - 1} - 1) + 1 \\
&amp;=&amp; c2^n -1 \\
&amp;&lt;&amp; c2^n
\end{eqnarray}
$$</p>
<h2 id="44-5">4.4-5</h2>
<h2 id="44-6">4.4-6</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = T(\frac{n}{3}) + T(\frac{2n}{3})$ and assume that n is an exact power of 3.</p>
<p><img alt="Alt text" src="../4.4-6.png" /></p>
<p>Each level has 2 times more nodes than the level above, so the number of nodes at depth i is $2^i$. But in this question, not all leaves reach at the bottom at the same time. The left most branch reaches the bottom first. So when the left most branch reaches the bottom, we assume other nodes also reach the bottom. Then the depth of recursion tree is $\log_3{n}$.</p>
<p>The total cost over all nodes at depth i, is $cn$ and the cost at bottom is also cn So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;\geq&amp; \sum_{i = 0}^{\log_3{n} - 1}cn + cn \\
&amp;=&amp; cn\log_3{n} + cn \\
&amp;=&amp; \frac{c}{\lg3}n\lg{n} + cn \\
&amp;=&amp; \Theta(n\lg{n})
\end{eqnarray}
$$</p>
<p>But remember we've cut some branches of the recursion tree, so $T(n) = \Omega(n\lg{n})$.</p>
<h2 id="44-7">4.4-7</h2>
<p>When n is large, the difference between $\frac{n}{2}$ and $\lfloor \frac{n}{2} \rfloor$ not that large, so it's also a sloppiness that we can tolerate. Then let's create a recursion tree for the recurrence $T(n) = 4T(\frac{n}{2}) + cn$ and assume that n is an exact power of 2.</p>
<p><img alt="Alt text" src="../4.4-7.png" /></p>
<p>Each level has 4 times more nodes than the level above, so the number of nodes at depth i is $4^i$. And each node at depth i, for $i = 0, 1, 2, \ldots, \lg{n} - 1$, has a cost of $\frac{cn}{2^i}$. So the total cost over all nodes at depth i, is $4^i\frac{cn}{2^i} = c2^in$. The bottom level, at depth $\lg{n}$, has $4^{\lg{n}} = n^2$ nodes, each contributing cost $T(1)$, for a total cost of $n^2T(1)$, which is $\Theta(n^2)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; \sum_{i = 0}^{\lg{n} - 1}c2^in + \Theta(n^2) \\
&amp;=&amp; cn\frac{1 - 2^{\lg{n}}}{1 - 2} + \Theta(n^2) \\
&amp;=&amp; \Theta(n^2)
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n^2)$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq dn^2$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 4T(\lfloor \frac{n}{2} \rfloor) + cn \\
&amp;\leq&amp; 4T(\frac{n}{2}) + cn \\
&amp;\leq&amp; 4d(\frac{n}{2})^2 + cn \\
&amp;=&amp; dn^2 + cn
\end{eqnarray}
$$</p>
<p>But $dn^2 + cn &gt; dn^2$, so let's try another guess, let's try $T(n) \leq dn^2 - dn$.</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 4T(\lfloor \frac{n}{2} \rfloor) + cn \\
&amp;\leq&amp; 4T(\frac{n}{2}) + cn \\
&amp;\leq&amp; 4d((\frac{n}{2})^2 - \frac{n}{2}) + cn \\
&amp;=&amp; dn^2 + (c - 2d)n \\
&amp;\leq&amp; dn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \geq \frac{c}{2}$.</p>
<p>So $T(n) = O(n^2)$. Then we want to show that $T(n) \geq dn^2$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; 4T(\lfloor \frac{n}{2} \rfloor) + cn \\
&amp;\geq&amp; 4T(\frac{n - (2 - 1)}{2}) + cn \\
&amp;=&amp; 4T(\frac{n - 1}{2}) + cn \\
&amp;\geq&amp; 4d(\frac{n - 1}{2})^2 + cn \\
&amp;=&amp; dn^2 + (c - 2d)n + d \\
&amp;&gt;&amp; dn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d &lt; \frac{c}{2}$.</p>
<p>So $T(n) = \Omega(n^2)$, so $T(n) = \Theta(n^2)$.</p>
<h2 id="44-8">4.4-8</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = T(n - a) + T(a) + cn$ and assume that n - 1 is divisible by a.</p>
<p><img alt="Alt text" src="../4.4-8.png" /></p>
<p>The total cost over all nodes at depth i, for $i = 0, 1, 2, \ldots, \frac{n - 1}{a} - 1$, is $c(n - (i - 1)a), \text{ for } i \geq 1$. The bottom level, at depth $\frac{n - 1}{a}$, the total cost is $T(1) + ca$, which is $\Theta(a)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; cn + \sum_{i = 1}^{\frac{n - 1}{a} - 1}c(n - (i - 1)a) + \Theta(a) \\
&amp;=&amp; cn + \sum_{i = 1}^{\frac{n - 1}{a} - 1}cn - \sum_{i = 1}^{\frac{n - 1}{a} - 1}(i - 1)ca + \Theta(a) \\
&amp;=&amp; \frac{n - 1}{a}cn - \frac{n^2 - 2a -3na + 3a + 2a^2 + 1}{2a}c \\
&amp;=&amp; \frac{n^2 +3na - 3a - 2a^2 - 1}{2a}c \\
&amp;=&amp; \Theta(n^2)
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = \Theta(n^2)$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \leq dn^2$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(n - a) + T(a) + cn \\
&amp;\leq&amp; d(n - a)^2 + da^2 + cn \\
&amp;=&amp; dn^2 + (c - ad)n + (2a^2 - an)d \\
&amp;\leq&amp; dn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \geq \frac{c}{a}$ and $n \geq 2a$.</p>
<p>So $T(n) = O(n^2)$.</p>
<p>Then we want to show that $T(n) \geq dn^2$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(n - a) + T(a) + cn \\
&amp;\geq&amp; d(n - a)^2 + da^2 + cn \\
&amp;=&amp; dn^2 + (c - 2ad)n + 2a^2d \\
&amp;&gt;&amp; dn^2
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d &lt; \frac{c}{2a}$.</p>
<p>So $T(n) = \Omega(n^2)$. So $T(n) = \Theta(n^2)$.</p>
<h2 id="44-9">4.4-9</h2>
<p>First let's create a recursion tree for the recurrence $T(n) = T(\alpha{n}) + T((1 - \alpha)n) + cn$.</p>
<p><img alt="Alt text" src="../4.4-9.png" /></p>
<p>So we can see not each branch reaches at the bottom at the same time, it might be the left most branch reaches at the bottom first, or the right most branch reaches at the bottom first. It depends on which is smaller, $\alpha$ or $1 - \alpha$. Let $\alpha \leq 1 - \alpha$, so we get $\alpha \leq \frac{1}{2}$. That is, when $0 &lt; \alpha \leq \frac{1}{2}$, the left most branch reaches at the bottom first, when $\frac{1}{2} &lt; \alpha &lt; 1$, the right most branch reaches at the bottom first.</p>
<p>If $0 &lt; \alpha \leq \frac{1}{2}$, when the left most branch reaches at the bottom, let's assume other branches also reach at the bottom, so the total cost over all nodes at depth i, for $i = 0, 1, 2, ... , \log_{\alpha}{\frac{1}{n}} - 1$, is cn. The cost at the bottom is also cn. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\geq&amp; \sum_{i = 0}^{\log_{\alpha}\frac{1}{n} - 1}cn + cn \\
&amp;=&amp; cn(\log_{\alpha}\frac{1}{n}) + cn \\
&amp;=&amp; cn\frac{\lg{n}}{\lg{\frac{1}{\alpha}}} + cn \\
&amp;&gt;&amp; cn\frac{\lg{n}}{\lg{\frac{1}{\alpha}}} \\
&amp;=&amp; \Omega(n\lg{n})
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = \Omega(n\lg{n})$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \geq dn\lg{n}$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\geq&amp; d\alpha{n}\lg{(\alpha{n})} + d(1 - \alpha)n\lg{((1 - \alpha)n)} + cn \\
&amp;=&amp; d\alpha{n}(\lg{\alpha} + n) + d(1 - \alpha)n(\lg{(1 - \alpha)} + \lg{n}) + cn \\
&amp;=&amp; dn\lg{n} + d\alpha\lg{\alpha}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \\
&amp;\geq&amp;  dn\lg{n} + d\alpha\lg{\alpha}n + d\alpha\lg{\alpha}n + cn \, (0 &lt; \alpha \leq \frac{1}{2}) \\
&amp;=&amp; dn\lg{n} + (c + 2d\alpha\lg{\alpha})n \\
&amp;\geq&amp; dn\lg{n}
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \leq \frac{c}{2\alpha\lg{\frac{1}{\alpha}}}$.</p>
<p>Now let's check the right most branch. When it reaches at the bottom, other branches have already reached at the bottom, if the tree depth is k, let's assume other branches become T(1) at depth k - 1.</p>
<p>Each level has two times more nodes than the level above, so the number of nodes at depth i is $2^i$. And total cost over all nodes at depth i, for $i = 0, 1, 2, ..., \log_{1 - \alpha}\frac{1}{n}$, is cn. The cost at the bottom is $T(1)$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\leq&amp; \sum_{i = 0}^{\log_{1 - \alpha}\frac{1}{n} - 1}cn + \Theta(1) \\
&amp;=&amp; cn(\log_{1 - \alpha}\frac{1}{n}) + \Theta(1) \\
&amp;=&amp; cn\frac{\lg{n}}{\lg_{\frac{1}{1 - \alpha}}} + \Theta(1) \\
&amp;&lt;&amp; cn\frac{\lg{n}}{\lg{\frac{1}{1 - \alpha}}} + n\lg{n}\\
&amp;=&amp; O(n\lg{n})
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n\lg{n})$ for our original recurrence. Now let's use the substitution method to veify that our guess was correct. We want to show that $T(n) \leq dn\lg{n}$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\leq&amp; d\alpha{n}\lg{(\alpha{n})} + d(1 - \alpha)n\lg{((1 - \alpha)n)} + cn \\
&amp;=&amp; d\alpha{n}(\lg{\alpha} + n) + d(1 - \alpha)n(\lg{(1 - \alpha)} + \lg{n}) + cn \\
&amp;=&amp; dn\lg{n} + d\alpha\lg{\alpha}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \\
&amp;\leq&amp;  dn\lg{n} + d(1 - \alpha)\lg{(1 - \alpha)}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \, (0 &lt; \alpha \leq \frac{1}{2}) \\
&amp;=&amp; dn\lg{n} + (c + 2d(1 - \alpha)\lg{(1 - \alpha)})n \\
&amp;\leq&amp; dn\lg{n}
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \geq \frac{c}{2(1 - \alpha)\lg{\frac{1}{1 - \alpha}}}$.</p>
<p>So we proved $T(n) = \Omega(n\lg{n})$ and $T(n) = O(n\lg{n})$. So $T(n) = \Theta(n\lg{n})$ when $0 &lt; \alpha \leq \frac{1}{2}$.</p>
<p>Then let's check another case, when $\frac{1}{2} &lt; \alpha &lt; 1$. In this case, the right most branch reaches at the bottom first. Let's assume other branches also reach at the bottom, so the total cost over all nodes at depth i, for $i = 0, 1, 2, ... , \log_{1 - \alpha}\frac{1}{n}$, is cn. The cost at the bottom is cn. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\geq&amp; \sum_{i = 0}^{\log_{1 - \alpha}\frac{1}{n} - 1}cn + cn \\
&amp;=&amp; cn(\log_{1 - \alpha}\frac{1}{n}) + cn \\
&amp;=&amp; cn\frac{\lg{n}}{\lg_{\frac{1}{1 - \alpha}}} + cn \\
&amp;&gt;&amp; cn\frac{\lg{n}}{\lg_{\frac{1}{1 - \alpha}}} \\
&amp;=&amp; \Omega(n\lg{n})
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = \Omega(n\lg{n})$ for our original recurrence. Now let's use the substitution method to verify that our guess was correct. We want to show that $T(n) \geq dn\lg{n}$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\geq&amp; d\alpha{n}\lg{(\alpha{n})} + d(1 - \alpha)n\lg{((1 - \alpha)n)} + cn \\
&amp;=&amp; d\alpha{n}(\lg{\alpha} + n) + d(1 - \alpha)n(\lg{(1 - \alpha)} + \lg{n}) + cn \\
&amp;=&amp; dn\lg{n} + d\alpha\lg{\alpha}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \\
&amp;&gt;&amp; dn\lg{n} + d(1 - \alpha)\lg{(1 - \alpha)}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \, (\frac{1}{2} &lt; \alpha &lt; 1) \\
&amp;=&amp; dn\lg{n} + (c + 2d(1 - \alpha)\lg{(1 - \alpha)})n \\
&amp;\geq&amp; dn\lg{n}
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \leq \frac{c}{2(1 - \alpha)\lg{\frac{1}{1 - \alpha}}}$.</p>
<p>Now let's check the left most branch. When it reaches at the bottom, other branches have already reached at the bottom, if the tree depth is k, let's assume other branches become T(1) at depth k - 1.</p>
<p>Each level has two times more nodes than the level above, so the number of nodes at depth i is $2^i$. And total cost over all nodes at depth i, for $i = 0, 1, 2, ... , \log_{\alpha}\frac{1}{n} - 1$, is cn. The cost at the bottom is T(1). So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;&lt;&amp; \sum_{i = 0}^{\log_{\alpha}\frac{1}{n} - 1}cn + \Theta(1) \\
&amp;=&amp; cn(\log_{\alpha}\frac{1}{n}) + \Theta(1) \\
&amp;=&amp; cn\frac{\lg{n}}{\lg_{\frac{1}{\alpha}}} + \Theta(1) \\
&amp;&lt;&amp; cn\frac{\lg{n}}{\lg{\frac{1}{\alpha}}} + n\lg{n}\\
&amp;=&amp; O(n\lg{n})
\end{eqnarray}
$$</p>
<p>Thus, we have derived a guess of $T(n) = O(n\lg{n})$ for our original recurrence. Now let's use the substitution method to veify that our guess was correct. We want to show that $T(n) \leq dn\lg{n}$ for some constant $d &gt; 0$. So:</p>
<p>$$
\begin{eqnarray}
T(n) &amp;=&amp; T(\alpha{n}) + T((1 - \alpha)n) + cn \\
&amp;\leq&amp; d\alpha{n}\lg{(\alpha{n})} + d(1 - \alpha)n\lg{((1 - \alpha)n)} + cn \\
&amp;=&amp; d\alpha{n}(\lg{\alpha} + n) + d(1 - \alpha)n(\lg{(1 - \alpha)} + \lg{n}) + cn \\
&amp;=&amp; dn\lg{n} + d\alpha\lg{\alpha}n + d(1 - \alpha)\lg{(1 - \alpha)}n + cn \\
&amp;&lt;&amp;  dn\lg{n} + d\alpha\lg{\alpha}n + d\alpha\lg{\alpha}n + cn \, (\frac{1}{2} &lt; \alpha &lt; 1) \\
&amp;=&amp; dn\lg{n} + (c + 2d\alpha\lg{\alpha})n \\
&amp;\leq&amp; dn\lg{n}
\end{eqnarray}
$$</p>
<p>where the last step holds as long as $d \geq \frac{c}{2\alpha\lg{\frac{1}{\alpha}}}$.</p>
<p>So we proved $T(n) = \Omega(n\lg{n})$ and $T(n) = O(n\lg{n})$. So $T(n) = \Theta(n\lg{n})$ when $\frac{1}{2} &lt; \alpha &lt; 1$. Thus $T(n) = \Theta(n\lg{n})$ for all $0 &lt; \alpha &lt; 1$.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../4.5-The-master-method-for-solving-recurrences/" class="btn btn-neutral float-right" title="4.5 The master method for solving recurrences">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../4.3-The-substitution-method-for-solving-recurrences/" class="btn btn-neutral" title="4.3 The substitution method for solving recurrences"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../4.3-The-substitution-method-for-solving-recurrences/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../4.5-The-master-method-for-solving-recurrences/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_SVG" defer></script>
      <script src="../../mathjax-config.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
