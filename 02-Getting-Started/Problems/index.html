<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Problems - Introduction to Algorithms</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Problems";
    var mkdocs_page_input_path = "02-Getting-Started\\Problems.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Introduction to Algorithms</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">2 Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../2.1-Insertion-sort/">2.1 Insertion sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../2.2-Analyzing-algorithms/">2.2 Analyzing algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../2.3-Designing-algorithms/">2.3 Designing algorithms</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Problems</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#problems">Problems</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#2-1">2-1</a></li>
        
            <li><a class="toctree-l4" href="#2-2">2-2</a></li>
        
            <li><a class="toctree-l4" href="#2-3">2-3</a></li>
        
            <li><a class="toctree-l4" href="#2-4">2-4</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">3 Growth of Functions</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.1-Asymptotic-notation/">3.1 Asymptotic notation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/3.2-Standard-notations-and-common-functions/">3.2 Standard notations and common functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../03-Growth-of-Functions/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">4 Divide and Conquer</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.1-The-maximum-subarray-problem/">4.1 The maximum-subarray problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.2-Strassen's-algorithm-for-matrix-multiplication/">4.2 Strassen's algorithm for matrix multiplication</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.3-The-substitution-method-for-solving-recurrences/">4.3 The substitution method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.4-The-recursion-tree-method-for-solving-recurrences/">4.4 The recursion-tree method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.5-The-master-method-for-solving-recurrences/">4.5 The master method for solving recurrences</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/4.6-Proof-of-the-master-theorem/">4.6 Proof of the master theorem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../04-Divide-and-Conquer/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">5 Probabilistic Analysis and Randomized Algorithms</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.1-The-hiring-problem/">5.1 The hiring problem</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.2-Indicator-random-variables/">5.2 Indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.3-Randomized-algorithms/">5.3 Randomized algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/5.4-Probabilistic-analysis-and-further-uses-of-indicator-random-variables/">5.4 Probabilistic analysis and further uses of indicator random variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../05-Probabilistic-Analysis-and-Randomized-Algorithms/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">6 Heapsort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.1-Heaps/">6.1 Heaps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.2-Maintaining-the-heap-property/">6.2 Maintaining the heap property</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.3-Building-a-heap/">6.3 Building a heap</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.4-The-heapsort-algorithm/">6.4 The heapsort algorithm</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/6.5-Priority-queues/">6.5 Priority queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06-Heapsort/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">7 Quicksort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.1-Description-of-quicksort/">7.1 Description of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.2-Performance-of-quicksort/">7.2 Performance of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.3-A-randomized-version-of-quicksort/">7.3 A randomized version of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/7.4-Analysis-of-quicksort/">7.4 Analysis of quicksort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../07-Quicksort/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">8 Sorting in Linear Time</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.1-Lower-bounds-for-sorting/">8.1 Lower bounds for sorting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.2-Counting-sort/">8.2 Counting sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.3-Radix-sort/">8.3 Radix sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/8.4-Bucket-sort/">8.4 Bucket sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../08-Sorting-in-Linear-Time/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">9 Medians and Order Statistics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.1-Minimum-and-maximum/">9.1 Minimum and maximum</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.2-Selection-in-expected-linear-time/">9.2 Selection in expected linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/9.3-Selection-in-worst-case-linear-time/">9.3 Selection in worst-case linear time</a>
                </li>
                <li class="">
                    
    <a class="" href="../../09-Medians-and-Order-Statistics/Problems/">Problems</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">10 Elementary Data Structures</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.1-Stacks-and-queues/">10.1 Stacks and queues</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.2-Linked-lists/">10.2 Linked lists</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.3-Implementing-pointers-and-objects/">10.3 Implementing pointers and objects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../10-Elementary-Data-Structures/10.4-Representing-rooted-trees/">10.4 Representing rooted trees</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Introduction to Algorithms</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>2 Getting Started &raquo;</li>
        
      
    
    <li>Problems</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="problems">Problems</h1>
<h2 id="2-1">2-1</h2>
<h3 id="a">a</h3>
<p>We know that the worst-case running time of sorting $n$ elements with insertion sort is $\Theta(n^2)$. So the running time of sorting $k$ elements is $\Theta(k^2)$. And there are $\frac{n}{k}$ sublists of length $k$, so the whole running time is $\frac{n}{k} * \Theta(k^2) = \Theta(nk)$.</p>
<h3 id="b">b</h3>
<p>We can go back to look at figure 2.5 in the book. In original merge sort, there are $n$ elements at the bottom in recursion tree. In each step, current array will be divided into two subarrays, until the array only contains one element. But in the modified algorithm, this operation stops when current array contains less than $k$ elements. Thus, it stops after $\lg{\frac{n}{k}}$ recursions. So the height of recursion tree is $\lg{\frac{n}{k}} + 1$. Because each level contributes a cost of $\Theta(n)$ merge operation, the total merge running time is $\Theta(n)(\lg{\frac{n}{k}} + 1) = \Theta(n\lg{\frac{n}{k}})$.</p>
<h3 id="c">c</h3>
<p>Given the modified algorithm runs in $\Theta(nk + n\lg{\frac{n}{k}})$ worst-case time, we know $n\lg{\frac{n}{k}} \leq n\lg{n}$, so this part will not influence the upper bound running time. Thus $nk$ is responsible for the worst-case running time of the modified algorithm. And we can see if $k$ is larger than $\lg{n}$, the modified algorithm will not have the same running time as the standard merge sort algorithm. So the largest value of $k$ is $\lg{n}$.</p>
<h3 id="d">d</h3>
<p>The optimum value of $k$ is system dependent. A optimum value on one machine may not be optimum on another machine.</p>
<h2 id="2-2">2-2</h2>
<h3 id="a_1">a</h3>
<p>We need to prove the array A' consists of the elements originally in A.</p>
<h3 id="b_1">b</h3>
<p>Loop invariant:</p>
<p><strong>At the start of each iteration of the for loop of lines 2-4, A[j] is the smallest in the subarray A[j..n]</strong>.</p>
<p><strong>Initialization</strong>: at the start of the iteration, j is n, and the subarray A[j..n] only contains one element, which is of course the smallest.</p>
<p><strong>Maintenance</strong>: if it is true before an iteration of the loop, we have A[j] is the smallest one in the subarray A[j..n]. Then we compare A[j - 1] and A[j], if A[j - 1] is smaller, we exchange A[j] with A[j - 1], thus A[j - 1] is the smallest one in the subarray A[j - 1..n]. So it remains true before the next iteration.</p>
<p><strong>Termination</strong>: it terminates when j equals to i. And when it terminates, we know A[i] is the smallest element in the subarray A[i..n]. So the loop invariant is correct.</p>
<h3 id="c_1">c</h3>
<p>Loop invariant:</p>
<p><strong>At the start of each iteration of the for loop of lines 1-4, the subarray A[1..i - 1] is in sorted order, and any element in the subarray A[1..i - 1] is not larger than any element in the subarray A[i..n]</strong>.</p>
<p><strong>Initialization</strong>: at the start of the iteration, i is 1, the subarray A[1..i - 1] is empty, the loop invariant is true.</p>
<p><strong>Maintenance</strong>: if it is true before an iteration of the loop, we have the subarray A[1..i - 1] is in sorted order. After the for loop in lines 2-4, A[i] is the smallest in the subarray A[i..n]. Because the elements in the subarray A[1..i - 1] is not larget than the elements in the subarray A[i..n], we know the subarray A[1..i] is still sorted. It remains true before the next iteration.</p>
<p><strong>Termination</strong>: it terminates when i is n. Substituting n for i in the wording of loop invariant, we have that the subarray A[1..n - 1] is in sorted order, and the elements in the subarray A[1..n - 1] is not larger than the elements in the subarray A[n..n], so the subarray A[1..n] is in sorted order. And the subarray A[1..n] is the entire array, we conclude that the entire array is sorted. Hence, the algorithm is correct.</p>
<h3 id="d_1">d</h3>
<p>The worst-case running time of bubblesort is approximately $n + (n - 1) + \ldots + 3 = \Theta(n^2)$.</p>
<p>The worst-case running time of insertion sort is also $\Theta(n^2)$, but the best-case running time of insertion sort is $\Theta(n)$. For bubblesort, the best-case running time is still $\Theta(n^2)$, because a best-case input could not reduce the cost of the for loop of lines 2-4.</p>
<h2 id="2-3">2-3</h2>
<h3 id="a_2">a</h3>
<p>It's $\Theta(n)$.</p>
<h3 id="b_2">b</h3>
<p>The pseudocode of the naive polynomial-evaluation algorithm:</p>
<pre><code>POLYNOMIAL-EVALUATION(A, x)

y = 0

for i = 0 to n
    a = A[i]
    x_product = 1

    for j = 1 to i
        x_product = x_product * x

    y = y + a * x_product
</code></pre>

<p>The running time of this algorithm is $\Theta(n^2)$. It's slower than the Horner's rule.</p>
<h3 id="c_2">c</h3>
<p><strong>Initialization</strong>: at the start of the iteration of the for loop, i is n, and $y = \sum_{k = 0}^{-1} a_{k + n + 1}{x^k}$, this is not a valid summation, so y is still 0. Thus the loop invariant is correct.</p>
<p><strong>Maintenance</strong>: at the start of the ith iteration, we have:
$$y = \sum_{k = 0}^{n - (i + 1)} a_{k + i + 1}{x^k}$$</p>
<p>And after the ith iteration, we have:</p>
<p>$$
\begin{eqnarray}
y &amp;=&amp; a_i + xy = a_i + x\sum_{k = 0}^{n - (i + 1)} a_{k + i + 1}{x^k} \\\
&amp;=&amp; a_i + x(a_{i + 1}x^0 + a_{i + 2}x^1 + \ldots + a_nx^{n - i - 1}) \\\
&amp;=&amp; a_i + a_{i + 1}x^1 + a_{i + 2}x^2 + \ldots + a_nx^{n - i} \\\
&amp;=&amp; a_ix^0 + a_{i + 1}x^1 + a_{i + 2}x^2 + \ldots + a_nx^{n - i} \\\
&amp;=&amp; \sum_{k = 0}^{n - i} a_{k + i}{x^k} \\\
&amp;=&amp; \sum_{k = 0}^{n - ((i - 1) + 1)} a_{k + (i - 1) + 1}{x^k}
\end{eqnarray}
$$</p>
<p>So the loop invariant is still true after the end of ith iteration.</p>
<p><strong>Termination</strong>: when the for loop terminates, i is -1, and we replace i with -1 in the summation:</p>
<p>$$y = \sum_{k = 0}^{n - (-1 + 1)} a_{k + -1 + 1}{x^k} = \sum_{k = 0}^{n} a_{k}{x^k}$$</p>
<p>So the loop invariant is correct.</p>
<h3 id="d_2">d</h3>
<p>At the end of the iteration of the for loop of lines 2-3, we have $y = \sum_{k = 0}^{n} a_{k}{x^k}$, so it's correct.</p>
<h2 id="2-4">2-4</h2>
<h3 id="a_3">a</h3>
<p>$\langle 0, 4\rangle, \langle 1, 4\rangle, \langle 2, 3\rangle, \langle 2, 4\rangle, \langle 6, 1\rangle$.</p>
<h3 id="b_3">b</h3>
<p>The array $\lbrace n, \ldots, 2, 1\rbrace$ has the most inversions. It has:</p>
<p>$$(n - 1) + (n - 2) + \ldots + 1 = \frac{n(n - 1)}{2}$$</p>
<h3 id="c_3">c</h3>
<p>Let's go back to the pseudocode of insertion sort. We know the running time of insertion sort is:</p>
<p>$$T(n) = c_1n + c_2(n - 1) + c_4(n - 1) + c_5\sum_{j = 2}^{n} t_j + c_6\sum_{j = 2}^{n} (t_j - 1) + c_7\sum_{j = 2}^{n} (t_j - 1) + c_8(n - 1)$$</p>
<p>where $t_j$ is the number of times the while loop test in line 5 is executed for the jth outer for loop.</p>
<p>We can see lines 6 and 7 will be executed when there is an inversion, let's denote $p_j$ the number of inversions in the subarray A[1..j]. So we have $p_j = t_j - 1$. When j is increasing, the number of inversions in the whole array A[1..n] is decreasing, but it doesn't create new inversions in eath iteration, since the relative order in subarray A[1..j] and A[j + 1..n] are not changed. So if we denote $m$ the number of inversions in the whole array A, we have $\sum_{j = 2}^{n} p_j = \sum_{j = 2}^{n} (t_j - 1) = m$. So:</p>
<p>$$T(n) = c_1n + c_2(n - 1) + c_4(n - 1) + c_5(m + n - 1) + c_6m + c_7m + c_8(n - 1)$$</p>
<h3 id="d_3">d</h3>
<pre><code>NUMBER-OF-INVERSIONS(A)
    n = A.length

    return MERGE-SORT(A, 1, n)

MERGE-SORT(A, p, r)
    inversions = 0

    if p &lt; r
        q = [(p + q) / 2]

        inversions += MERGE-SORT(A, p, q)
        inversions += MERGE-SORT(A, q + 1, r)
        inversions += MERGE(A, p, q, r)

    return inversions

MERGE(A, p, q, r)

n1 = q - p + 1
n2 = r - q
let L[1..n1] and R[1..n2] be new arrays
for i = 1 to n1
    L[i] = A[p + i - 1]
for j = 1 to n2
    R[j] = A[q + j]
i = 1
j = 1
inversions = 0
for k = p to r
    if i &gt; n1:
        A[k] = R[j]
        j = j + 1
    else if j &gt; n2:
        A[k] = L[i]
        i = i + 1
    else if L[i] &lt;= R[j]:
        A[k] = L[i]
        i = i + 1
    else
        A[k] = R[j]
        j = j + 1
        inversions += n1 - i + 1
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../03-Growth-of-Functions/3.1-Asymptotic-notation/" class="btn btn-neutral float-right" title="3.1 Asymptotic notation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../2.3-Designing-algorithms/" class="btn btn-neutral" title="2.3 Designing algorithms"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../2.3-Designing-algorithms/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../03-Growth-of-Functions/3.1-Asymptotic-notation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../mathjax-config.js" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
